---
title: "Machine Learning"
author: "Maximiliano Galoto"
subtitle: "Knn Predict Mooshroom Model"
output:
 prettydoc::html_pretty:
    theme: lumen
    highlight: github
    toc: true
    toc_depth: 2
    math: katex

---


```{css my-header-colors, echo = FALSE}
.page-header {
    background-image: url('https://media0.giphy.com/media/1fgLkB8QIZO5KdQLL8/giphy.gif?cid=ecf05e47z44e2m8kas7bhs81wz9kof5q4jrec0dswgcd92nu&rid=giphy.gif&ct=g');
    border: solid 1px black;
    border-radius: .3rem;
    background-size: cover;
}

```

```{css , echo = FALSE}

.myimg {
  border: solid 1px black;
}

```


<style type="text/css">

.toc .toc-box {
    padding: 1.5rem;
    background-color: #f5f5f5;
    border: solid 1px #6b6b6b;
    border-radius: .3rem;
}

a {
    color: black;
    text-decoration: none;
    font-weight: bold;
}



.main-content h2, .main-content h3, .main-content h4, .main-content h5, .main-content h6 {
    margin-top: 2rem;
    margin-bottom: 1rem;
    font-weight: 400;
    color: black;
}


.main-content h1 {
    margin-top: 2rem;
    margin-bottom: 1rem;
    font-weight: 750;
    background-image: url('https://media0.giphy.com/media/1fgLkB8QIZO5KdQLL8/giphy.gif?cid=ecf05e47z44e2m8kas7bhs81wz9kof5q4jrec0dswgcd92nu&rid=giphy.gif&ct=g');
    background-position: center;
    color: white;
    text-align: center;
    border: solid 1px black;
    border-radius: .3rem;
    background-color: #f5f5f5;
} 



h1.title {
  font-size: 58px;
  color: white;
  text-align: center;
}
h3.subtitle { 
    font-size: 28px;
  font-family: "Times New Roman", Times, serif;
  color: white ;
  text-align: center;
}
h4.author { 
    font-size: 24px;
  font-family: "Times New Roman", Times, serif;
  color:white ;
  text-align: center;
}

.main-content table th {
    font-weight: 700;
    background-color: blue;
    color: rgb(255, 255, 255);
}




</style>

<br>
</br>






<div style="text-align: left" class="toc-box">
# 1 - Introduccion
</div>
<div style="text-align: right" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>
<br>
</br>

```{r, echo=FALSE, out.width="45%", fig.align='center'}
knitr::include_graphics("https://c.tenor.com/RpShjXCcGiEAAAAC/trippy-mushroom.gif")
```


El siguiente trabajo consiste en un análisis preliminar de los datos de la inmobiliaria [Properatti](https://www.properati.com.ar/) luego de una visualización, limpieza y segmentación por CABA [(Ver trabajo Aqui)](https://rpubs.com/MGaloto/data_wrangling) para luego entrenar un modelo de <span style="color:blue">*Regresión Logística*</span> que nos sirva para predecir el precio en dolares por metro cuadrado. 


<br>
</br>


**_Librerías_**

Para utilizar código <span style="color:blue">*Python*</span> en R Markdown se usa la librería reticulate.
 
```{r}

library(reticulate)

Sys.setenv(RETICULATE_PYTHON = 'C:/ProgramData/Anaconda3/python.exe')

use_python('C:/ProgramData/Anaconda3/python.exe')

```




```{python, warning=FALSE}


```

<div style="text-align: left" class="toc-box">
# 2 - Lectura del Data Set
</div>
<div style="text-align: right" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>
<br>
</br>



```{python}


```


```{python}



```



```{python}


```


*Se pueden observar dispersiones en los datos que perjudican la estimación de los parámetros de una regresión lineal. La idea principal es homogeneizar los datos lo mejor posible sin alterar la naturaleza de los mismos para generalizar y minimizar los errores.*


```{python}


```




```{python}
```





```{python}
```

Distribucion inicial de los precios en dolares por metro cuadrado:


```{python}
```




<div style="text-align: left" class="toc-box">
# 3 - Limpieza de Datos 
</div>
<div style="text-align: right" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>
<br>
</br>


```{python}
```




```{python}
```




```{python}
```


```{python}
```



```{python}
```






```{python}
```



```{python}
```



```{python}
```


<div style="text-align: left" class="toc-box">
# 4 - Visualizaciones Post Limpieza
</div>
<div style="text-align: right" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>
<br>
</br>



```{python}

```





```{python}
```





```{python}

```

```{python}
```

<div style="text-align: left" class="toc-box">
# 5 - Variables Dummies
</div>
<div style="text-align: right" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>
<br>
</br>

El primer paso para estimar los parámetros del modelo es eliminar todas las filas que contienen al menos un dato nulo ya que el modelo no nos permite tener este tipo de valores.

En el segundo paso se seleccionan solo las observaciones que son departamentos para el modelo y se eliminan las filas de zonas que tienen pocas observaciones.

```{python}
```

```{python}
```

```{python}
```

La matriz de correlación nos sirve para ver si hay variables que se correlacionan para poder evitar multicolinealidad en el modelo:

```{python}


```


```{python}
```



Se crean variable dummies para las features categóricas y se separa el data set en training y set


```{python}
```


<div style="text-align: left" class="toc-box">
# 6 - Modelo
</div>
<div style="text-align: right" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>
<br>
</br>



```{python}
```

Se instancia y entrena el modelo de Linear Regression:

```{python}
```

Analizo los Betas

```{python}
```

La presencia de Puerto Madero hace incrementar la variable dependiente

```{python}


```

Para evaluar el modelo se utiliza el MAE, la validación cruzada y el r2. El MAE es el elegido ya que nos da un valor robusto para nuestro analisis, el valor absoluto del error promedio del modelo

El **error absoluto medio** (_Mean Absolut Error_ o MAE) es la media del valor absoluto de los errores:

$$ \frac 1n\sum_ {i = 1}^n |y_i-\hat{y}_i| $$


```{python}
```

+ El modelo arroja los siguientes resultados:


|Modelo||MAE|R2|MAE CV|R2 CV|
|-|-|-|-|-|-|
|Regresión Logística Nº1 ||434|0.60|432|0.59|

```{python}
```



<div style="text-align: left" class="toc-box">
# 7 - Conclusiones
</div>
<div style="text-align: right" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>
<br>
</br>

Se realizo una ultima limpieza del set de datos seleccionando solo los departamentos y las localidades que tienen mas de 20 observaciones. El modelo arroja resultados interesantes teniendo en cuenta las dificultades al momento de tratar valores atípicos ya que estos mismos son perjudiciales para un modelo de regresión lineal múltiple que busca hacer una generalización lo mejor posible para los datos.

Las pruebas de validación cruzada son consistentes con el primer resultado re R2 y error cuadrático medio. Se puede concluir que es un modelo en donde las variables independientes explican un 60 % de la variabilidad del precio en dolares por metro cuadrado y el error promedio de estimación es de 430 Usd el metro cuadrado.




